<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BBH+Sans+Hegarty&family=Playwrite+US+Modern:wght@100..400&display=swap" rel="stylesheet">
  <title>Pet Paths</title>
  <style>
    :root {
		--primary: #4a4fcf;
	  	--primary-dark: #3a3fb0;
	  	--bg: #f3f3f3;
		--text: #222;
	  	--btn-text: #fff;
	  	--header-bg: #4a4fcf;
		--header-text: #fff;
	}
    [data-theme="dark"] {
    	--primary: #222b45;
		--primary-dark: #151a30;
    	--bg: #181a20;
    	--text: #f3f3f3;
    	--btn-text: #fff;
		--header-bg: #222b45;
    	--header-text: #fff;
	}
	[data-theme="forest"] {
		--primary: #388e3c;
		--primary-dark: #256029;
		--bg: #e8f5e9;
		--text: #1b3a1b;
		--btn-text: #fff;
		--header-bg: #388e3c;
		--header-text: #fff;
	}
	[data-theme="ocean"] {
		--primary: #1976d2;
		--primary-dark: #0d47a1;
		--bg: #e3f2fd;
		--text: #0d223a;
		--btn-text: #fff;
		--header-bg: #1976d2;
		--header-text: #fff;
	}
	[data-theme="rose"] {
		--primary: #d81b60;
		--primary-dark: #880e4f;
		--bg: #fff1f6;
		--text: #3a1b2f;
		--btn-text: #fff;
		--header-bg: #d81b60;
		--header-text: #fff;
	}
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 100vh;
      text-align: center;
      transition: background 0.3s, color 0.3s;
    }

    .container {
      padding: 20px;
      flex: 1;
      animation: fadeInUp 1.5s ease-out;
    }

    h2 {
      margin: 0 0 10px 0;
      font-size: 1.2rem;
      font-weight: normal;
    }

    h1 {
      margin-top: 20px;
      font-size: 2rem;
      font-weight: bold;
      animation: bounceIn 1s ease-out 0.5s both;
    }

    p {
      font-size: 1rem;
      margin: 20px 0;
      line-height: 1.5;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .btn {
      display: block;
      width: fit-content;
      margin: 15px auto;
      padding: 12px 20px;
      background-color: var(--primary);
      color: var(--btn-text);
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
    }

    .btn:hover {
      background-color: var(--primary-dark);
    }

    /* Button container for responsive layout */
    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    @media (min-width: 769px) {
      .button-container {
        flex-direction: row;
        justify-content: center;
      }
    }

    /* Bottom nav bar */
    .footer {
      background-color: var(--primary);
      display: flex;
      justify-content: space-around;
      align-items: flex-end;
      padding: 14px 0 10px;
      position: fixed;
      bottom: 0;
      width: 100%;
      transition: background 0.3s;
    }

    .footer a {
      text-decoration: none;
      color: black;
      font-size: 24px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 1;
      z-index: 2;
      transition: transform 0.3s ease, font-size 0.3s ease;
    }

    .footer a i {
      position: relative;
      z-index: 3; /* icons always above circle */
      transition: transform 0.3s ease, font-size 0.3s ease;
    }

    /* Circle behind active icon */
    .footer a.active::before {
      content: "";
      width: 50px;
      height: 50px;
      background-color: var(--primary);
      border-radius: 50%;
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1;
    }

    /* Active icon larger + slight lift */
    .footer a.active i {
      font-size: 30px;
      transform: translateY(-5px);
    }

    /* Responsive tweaks */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      h1 {
        font-size: 1.6rem;
        margin-top: 15px;
      }
      h2 {
        font-size: 1.1rem;
        margin-bottom: 5px;
      }
      p {
        font-size: 0.95rem;
        padding: 0 10px;
        margin: 15px 0;
      }
      .btn {
        font-size: 0.95rem;
        padding: 10px 18px;
        width: 100%;
        max-width: 300px;
        margin: 10px auto;
      }
      .footer a {
        font-size: 22px;
      }
      .footer a.active::before {
        width: 40px;
        height: 40px;
        top: -22px;
      }
      .footer a.active i {
        font-size: 28px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 10px;
      }
      h1 {
        font-size: 1.4rem;
        margin-top: 0; /* Remove top margin for tighter spacing */
      }
      h2 {
        font-size: 1rem;
        margin-bottom: 0; /* Tighter spacing between h2 and h1 */
      }
      p {
        font-size: 0.9rem;
        margin: 10px 0;
      }
      .btn {
        font-size: 0.9rem;
        padding: 9px 16px;
        width: 100%;
        max-width: 300px;
        margin: 8px auto;
      }
      .footer a {
        font-size: 20px;
      }
      .footer a.active::before {
        width: 36px;
        height: 36px;
        top: -20px;
      }
      .footer a.active i {
        font-size: 26px;
      }
    }
    .name {
      font-family: "BBH Sans Hegarty", sans-serif;
      font-weight: 400;
      font-style: normal;
    }
    .whatsapp-btn {
      display: inline-flex;
      align-items: center;
      background-color: #25D366;
      color: white;
      padding: 10px 18px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 16px;
      font-family: Arial, sans-serif;
      transition: background 0.2s ease;
    }
    .whatsapp-btn:hover {
      background-color: #1ebe5d;
    }
    .whatsapp-btn i {
      margin-right: 8px;
      font-size: 20px;
    }
    .github-btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: #24292f;      /* GitHub dark */
      color: #fff;
      padding: 10px 14px;
      border-radius: 6px;
      text-decoration: none;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      font-weight: 600;
      font-size: 15px;
      transition: transform .08s ease, box-shadow .12s ease, background .12s ease;
    }
    .github-btn:hover { background: #1b1f23; transform: translateY(-1px); }
    .github-btn:active { transform: translateY(0); }
    .github-btn:focus {
      outline: 3px solid rgba(36,41,47,0.18);
      outline-offset: 3px;
    }
    .github-btn .gh-icon { font-size: 18px; }

    /* Floating round icon (bottom-right) */
    .github-float {
      position: fixed;
      right: 18px;
      bottom: 18px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: #24292f;
      color: white;
      text-decoration: none;
      box-shadow: 0 10px 24px rgba(36,41,47,0.18);
      z-index: 1000;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .github-float:hover { transform: translateY(-3px); box-shadow: 0 14px 34px rgba(36,41,47,0.22); }
    .github-float:focus { outline: 3px solid rgba(36,41,47,0.18); outline-offset: 3px; }
    .github-float i { font-size: 22px; }

    /* New animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3);
      }
      50% {
        opacity: 1;
        transform: scale(1.05);
      }
      70% {
        transform: scale(0.9);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }
  </style>
  
  <!-- Font Awesome -->
  <link 
    rel="stylesheet" 
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
    crossorigin="anonymous" 
    referrerpolicy="no-referrer" 
  />
</head>
<body>
  <script>
    // Redirect unverified users to the verification page
    if (!localStorage.getItem("petpaths_verified")) {
      window.location.href = "verify.html";
    }
  </script>
  <script>
    // Theme loader for all pages
    (function() {
      const theme = localStorage.getItem('petpaths_theme') || 'light';
      document.documentElement.setAttribute('data-theme', theme);
    })();

    fetch('https://api.ipify.org?format=json')
      .then(r => r.json())
      .then(data => {
        const ip = data.ip;
        fetch(`https://pet-paths-default-rtdb.europe-west1.firebasedatabase.app/clients/${ip}.json`, {
          method: 'PUT',
          body: JSON.stringify({ lastSeen: Date.now() })
        });
      });
  </script>
  <div class="container">
    <h2>Welcome to</h2> 
    <h1 class="name"><i><u>pet paths!</u></i></h1>
    <p>
      We are devoted to bringing safer dog walks to the world.  
      By using Pet Paths you are contributing to our vision of  
      creating happier communities for pets and their owners.  
      Every walk, every report, and every connection makes a difference.
    </p>
    
    <div id="homeBanner" style="
      display:none;
      position:relative;
      margin:20px auto;
      padding:14px 18px 14px 18px;
      max-width:600px;
      border-radius:10px;
      background:var(--primary);
      color:var(--btn-text);
      font-size:1rem;
      font-family:system-ui,sans-serif;
      animation:fadeInUp 0.6s ease-out;
      box-shadow:0 4px 12px rgba(0,0,0,0.15);
    ">
      <span id="homeBannerText"></span>
      <button id="closeBannerBtn" aria-label="Dismiss message" style="
        position:absolute;
        top:6px;
        right:8px;
        background:transparent;
        border:none;
        color:var(--btn-text);
        font-size:18px;
        cursor:pointer;
        line-height:1;
      ">&times;</button>
    </div>

    <div class="button-container">
      <a href="walks.html" class="btn">Share your dog walk</a>
      <a href="playdates.html" class="btn">Propose a doggy play date</a>
      <a href="shop.html" class="btn">Shop for pet goodies</a>
    </div>
    <hr>
    <center>
      <blockquote style="font-size: 0.9rem; color: gray; max-width: 400px; margin: 10px auto;">
        small message from Oliver:
      </blockquote>
      Hi! Your support means a lot. If Pet Paths has made your walks a little brighter, join our WhatsApp community to stay connected and give our GitHub project a star ‚Äî it really helps us keep improving!
      <br><br>
      <em style="font-size: 0.8rem; color: #666;">P.S. Why did the dog sit in the shade? Because he didn't want to be a hot dog! üê∂üòÑ</em>
    </center>
    <hr>
    <br>
    <a href="https://whatsapp.com/channel/0029VbBAxdpLikgAGCMZuM16"
      class="whatsapp-btn"
      target="_blank"
      rel="noopener noreferrer">
      <i class="fa-brands fa-whatsapp"></i>
      Join our WhatsApp Channel
    </a>
    <br>
    <br>
    <a
      class="github-btn"
      href="https://github.com/oliver-lebaigue-pet-paths/pet-paths-new"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Open GitHub repository pet-paths-new"
      title="View on GitHub"
    >
      <i class="fa-brands fa-github gh-icon" aria-hidden="true"></i>
      View repo on GitHub
    </a>
    <br>
    <blockquote style="font-size: 0.9rem; color: gray; max-width: 400px; margin: 10px auto;">
      (You can do both, of course!)
    </blockquote>
  </div>

  <div class="footer">
    <a href="settings.html"><i class="fa-solid fa-gear"></i></a>
    <a href="playdates.html"><i class="fa-solid fa-calendar"></i></a>
    <a href="walks.html"><i class="fa-solid fa-dog"></i></a>
    <a href="index.html" class="active"><i class="fa-solid fa-house"></i></a>
    <a href="pet-net/index.html"><i class="fa-solidx fa-globe"></i></a>
    <a href="feedback.html"><i class="fa-solid fa-clipboard-list"></i></a>
    <a href="admin.html"><i class="fa-solid fa-user-shield"></i></a>
  </div>
    <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCMuOymY5KniYJgg51vkhcYWxXeyXAyFk0",
      authDomain: "pet-paths.firebaseapp.com",
      databaseURL: "https://pet-paths-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "pet-paths",
      storageBucket: "pet-paths.firebasestorage.app",
      messagingSenderId: "5202022310",
      appId: "1:5202022310:web:55991fbd2be58294bfc967",
      measurementId: "G-SW8L37HRVV",
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // üîπ Live notification listener
    onValue(ref(db, "admin/notification"), (snap) => {
      const data = snap.val();
      const message = data && data.message ? data.message.trim() : "";
      showGlobalNotification(message);
    });

    function showGlobalNotification(message) {
      let bar = document.getElementById("globalNotifBar");
      if (bar) bar.remove();

      if (!message) return; // no message -> nothing shown

      bar = document.createElement("div");
      bar.id = "globalNotifBar";
      bar.textContent = message;
      bar.style.position = "fixed";
      bar.style.top = "-50px";
      bar.style.left = 0;
      bar.style.right = 0;
      bar.style.background = "var(--primary)";
      bar.style.color = "var(--btn-text)";
      bar.style.textAlign = "center";
      bar.style.padding = "12px 16px";
      bar.style.fontFamily = "system-ui, sans-serif";
      bar.style.fontSize = "0.95rem";
      bar.style.zIndex = 10000;
      bar.style.boxShadow = "0 2px 8px rgba(0,0,0,0.25)";
      bar.style.transition = "top 0.4s ease";

      document.body.appendChild(bar);
      requestAnimationFrame(() => (bar.style.top = "0"));

      // Optional: click to dismiss
      bar.addEventListener("click", () => {
        bar.style.top = "-60px";
        setTimeout(() => bar.remove(), 400);
      });
    }

    // üîπ Homepage banner listener (dismissible)
    onValue(ref(db, "admin/homeMessage"), snap => {
      const message = snap.val() ? snap.val().trim() : "";
      const banner = document.getElementById("homeBanner");
      const bannerText = document.getElementById("homeBannerText");
      const closeBtn = document.getElementById("closeBannerBtn");

      if (!banner || !bannerText || !closeBtn) return;

      const dismissedKey = "bannerDismissed_" + (message || "none");

      // Check if dismissed already
      if (message && !localStorage.getItem(dismissedKey)) {
        banner.style.display = "block";
        bannerText.textContent = message;
      } else {
        banner.style.display = "none";
      }

      // Dismiss handler
      closeBtn.onclick = () => {
        banner.style.display = "none";
        if (message) localStorage.setItem(dismissedKey, "true");
      };
    });

    // üîπ Existing refresh watcher
    const clientId = "client_" + Math.random().toString(36).slice(2);
    let lastHandled = localStorage.getItem("last_refresh_id") || "0";

    onValue(ref(db, "admin/refresh"), (snap) => {
      const data = snap.val();
      if (!data || !data.value) return;

      const refreshId = String(data.value);
      if (refreshId === lastHandled) return; // already handled this one

      if (data.value !== 0 && data.sender !== clientId) {
        localStorage.setItem("last_refresh_id", refreshId);
        window.location.href = "https://pet-paths.site"; // redirect to main site
      }
    });
  </script>
</body>
</html>